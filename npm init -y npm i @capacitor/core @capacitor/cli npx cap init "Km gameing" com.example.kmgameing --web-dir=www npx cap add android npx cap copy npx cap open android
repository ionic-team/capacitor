<!doctype html><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Km gameing</title><canvas id=c width=480 height=320></canvas><div id=ui><button id=l>◀</button><button id=j>⤒</button><button id=s>●</button><button id=r>▶</button></div><script src="game.js"></script><link rel="stylesheet" href="style.css">
*{box-sizing:border-box}html,body{margin:0;background:#111;color:#fff;height:100%;touch-action:manipulation;-webkit-user-select:none;user-select:none}#c{display:block;margin:0 auto;background:linear-gradient(#223,#446);image-rendering:pixelated}#ui{position:fixed;inset:auto 0 8px 0;display:flex;gap:8px;justify-content:center}#ui button{font:700 18px/1 system-ui;padding:16px 18px;border:0;border-radius:14px;background:#2a2a2a;color:#fff;box-shadow:0 4px 12px #0007;min-width:64px}#ui button:active{transform:translateY(1px)}@media(min-width:640px){#c{margin-top:8px}}
(()=>{const C=document.getElementById("c"),X=C.getContext("2d"),W=C.width,H=C.height,G=0.5;let t=0,keys={l:0,r:0,j:0,s:0},player={x:40,y:H-48,w:18,h:22,vx:0,vy:0,canJump:!0,hp:3},bul=[],en=[],boss=null,score=0,over=!1;function rect(a,b,c,d,col){X.fillStyle=col;X.fillRect(a|0,b|0,c|0,d|0)}function aabb(A,B){return A.x<A.w+A.w?0:(A.x+B.w> B.x && A.x+A.w> B.x && A.x< B.x+B.w && A.y+B.h> B.y && A.y+A.h> B.y)}function coll(A,B){return A.x<B.x+B.w&&A.x+A.w>B.x&&A.y<B.y+B.h&&A.y+A.h>B.y}function spawnEnemy(){en.push({x:W+20,y:H-46,w:18,h:18,vx:-1.5-0.05*Math.min(score,30),hp:1,bad:1})}function spawnBoss(){boss={x:W-140,y:40,w:64,h:64,vx:-1.2,vy:0,hp:20,bad:1,t:0}}function shoot(){bul.push({x:player.x+player.w,y:player.y+player.h/2-2,w:10,h:4,vx:5,vy:0})}function inputBind(id,prop){const e=document.getElementById(id);const on=()=>keys[prop]=1,off=()=>keys[prop]=0;e.addEventListener("touchstart",e=>{e.preventDefault();on()},{passive:!1});e.addEventListener("touchend",off);e.addEventListener("mousedown",on);e.addEventListener("mouseup",off);e.addEventListener("mouseleave",off)}inputBind("l","l");inputBind("r","r");inputBind("j","j");inputBind("s","s");addEventListener("keydown",e=>{if(e.key==="ArrowLeft"||e.key==="a")keys.l=1;if(e.key==="ArrowRight"||e.key==="d")keys.r=1;if(e.key===" "||e.key==="w"||e.key==="ArrowUp")keys.j=1;if(e.key==="j"||e.key==="k")keys.s=1});addEventListener("keyup",e=>{if(e.key==="ArrowLeft"||e.key==="a")keys.l=0;if(e.key==="ArrowRight"||e.key==="d")keys.r=0;if(e.key===" "||e.key==="w"||e.key==="ArrowUp")keys.j=0;if(e.key==="j"||e.key==="k")keys.s=0});function upd(){if(over)return; t++; if(!boss&&score>=10)spawnBoss(); if(t%120===0&&!boss)spawnEnemy(); player.vx=(keys.r-keys.l)*2.2; if(keys.j&&player.canJump){player.vy=-8;player.canJump=!1} if(keys.s&&t%8===0)shoot(); player.vy+=G; player.x+=player.vx; player.y+=player.vy; if(player.y>H-46){player.y=H-46;player.vy=0;player.canJump=!0} player.x=Math.max(0,Math.min(W-player.w,player.x)); bul=bul.filter(b=>b.x<W); bul.forEach(b=>{b.x+=b.vx; b.y+=b.vy}); en=en.filter(e=>e.x>-40&&e.hp>0); en.forEach(e=>{e.x+=e.vx}); if(boss){boss.t++; boss.x+=boss.vx; if(boss.x< W-220||boss.x>W-70)boss.vx*=-1; boss.vy= Math.sin(boss.t/30)*0.8; boss.y=40+boss.vy*20} bul.forEach(b=>{en.forEach(e=>{if(coll(b,e)){e.hp-=1;b.x=W+99; if(e.hp<=0)score++}}); if(boss&&coll(b,boss)){boss.hp--; b.x=W+99; if(boss.hp<=0){score+=10; boss=null}}}); en.forEach(e=>{if(coll(player,e))player.hp=0}); if(boss&&coll(player,boss))player.hp=0; if(player.hp<=0)over=!0}function draw(){X.clearRect(0,0,W,H); rect(0,H-24,W,24,"#2e2"); rect(player.x,player.y,player.w,player.h,"#ffd800"); bul.forEach(b=>rect(b.x,b.y,b.w,b.h,"#fff")); en.forEach(e=>rect(e.x,e.y,e.w,e.h,"#f55")); if(boss){rect(boss.x,boss.y,boss.w,boss.h,"#a0f"); X.fillStyle="#fff"; X.fillRect(10,10,200,8); X.fillStyle="#a0f"; X.fillRect(10,10,Math.max(0,200*(boss.hp/20)),8)} X.font="12px system-ui"; X.fillStyle="#fff"; X.fillText("Score: "+score,10,H-36); X.fillText("HP: "+player.hp,10,H-20); if(over){X.fillStyle="#000a";X.fillRect(0,0,W,H);X.fillStyle="#fff";X.font="20px system-ui";X.fillText("Game Over",W/2-60,H/2);X.font="12px system-ui";X.fillText("Refresh page to retry",W/2-74,H/2+20)}}; (function loop(){upd();draw();requestAnimationFrame(loop)})()})();
